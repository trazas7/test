# 1) Trust the local HTTPS cert (one-time)
npx office-addin-dev-certs install

# 2) Allow WebView2 localhost loopback (one-time)
CheckNetIsolation LoopbackExempt -a -n=Microsoft.Win32WebViewHost_cw5n1h2txyewy

# 3) Enable developer sideloading
New-Item -Path HKCU:\Software\Microsoft\Office\16.0\WEF -Force | Out-Null
New-ItemProperty -Path HKCU:\Software\Microsoft\Office\16.0\WEF `
  -Name DeveloperSideloadingAllowed -PropertyType DWord -Value 1 -Force | Out-Null

# 4) Copy your manifest into the WEF folder
$wef = "$env:LOCALAPPDATA\Microsoft\Office\16.0\Wef"
$guid = "d3eeabdc-1e83-40ff-8857-7012cef4ec06"   # <-- your add-in Id
$dest = Join-Path $wef $guid
New-Item -ItemType Directory -Path $dest -Force | Out-Null
Copy-Item -Path ".\manifest.xml" -Destination (Join-Path $dest "manifest.xml") -Force
