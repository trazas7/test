export async function getPptSelectedTextOrShape(): Promise<string> {
  return PowerPoint.run(async (context) => {
    const pres = context.presentation;

    // NEW: Check if cursor is active in a text frame (including table cells)
    try {
      const activeCell = pres.getSelectedTextRange();
      activeCell.load("text");
      await context.sync();
      if (activeCell && activeCell.text) {
        return activeCell.text.trim();
      }
    } catch (e) {
      // No active text selection, continue with other checks
    }

    // 1) If the user has a text selection, return it.
    const selectedText = pres.getSelectedTextRangeOrNullObject();
    await context.sync();
    if (!selectedText.isNullObject) {
      selectedText.load("text");
      await context.sync();
      return (selectedText.text ?? "").trim();
    }
