async function getWordSelectedOrFullText(task: any): Promise<string> {
  return await Word.run(async (ctx) => {
    let result = "";

    const selection = ctx.document.getSelection();
    selection.load("text"); // load selection text to check if empty
    await ctx.sync();

    if (selection.text && selection.text.trim().length > 0) {
      // ✅ There is a selection → get HTML
      const html = selection.getHtml();
      await ctx.sync();

      const cleaned = minimizeHtml(html.value);
      if (cleaned) {
        result = cleaned;
      }
    } else if (!task.shouldSelectText && task.name !== "AD_HOC") {
      // ✅ No selection → get HTML from body
      const body = ctx.document.body;
      const html = body.getHtml();
      await ctx.sync();

      const cleaned = minimizeHtml(html.value);
      if (cleaned) {
        result = cleaned;
      }
    }

    console.log("result", result);
    return result;
  });
}