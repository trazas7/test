export async function getPptSelectedTextOrShape(): Promise<string> {
  return PowerPoint.run(async (context) => {
    const pres = context.presentation;

    // First, try to get selected text range (works for text in shapes AND table cells)
    try {
      const textRange: PowerPoint.TextRange = context.presentation.getSelectedTextRange();
      textRange.load("text");
      await context.sync();
      
      if (textRange && textRange.text) {
        // This will get the selected text, including from table cells
        return textRange.text.trim();
      }
    } catch (error) {
      console.log("No text range selected, checking for selected shapes...");
    }

    // Fallback: If no text range, check if shapes are selected
    const selectedShapes = pres.getSelectedShapes();
    selectedShapes.load("items/type,id,name");
    await context.sync();
    
    if (selectedShapes.items.length === 0) return "";

    const parts: string[] = [];
